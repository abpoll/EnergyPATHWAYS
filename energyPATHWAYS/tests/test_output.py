import unittest as ut
import energyPATHWAYS as ep
import os
from energyPATHWAYS.outputs import Output
from collections import defaultdict


class OutputTest(ut.TestCase):
    @classmethod
    def setUpClass(cls):
        d = os.path.dirname(os.path.realpath(__file__))
        cfgfile_path = os.path.join(d, 'test_config.INI')
        custom_pint_definitions_path = os.path.join(d, 'unit_defs.txt')
        ep.config.initialize_config(cfgfile_path, custom_pint_definitions_path)

    def test_outputs_id_map(self):
        output = Output()

        # TODO: (MAC) this is an overspecified test and very fragile to data changes in the database
        # I am waiting to figure out how to improve it until we have a simplified, stable test database
        expected_id_map = defaultdict(dict, {'sector': {1: 'RESIDENTIAL', 2: 'COMMERCIAL', 3: 'TRANSPORTATION', 4: 'PRODUCTIVE'}, 'bus types': {99: 'TRANSIT', 100: 'INTERCITY', 101: 'SCHOOL'}, 'AEO glass industry throughput categories': {142: 'P_FORM', 143: 'FORM', 144: 'M_RCYL', 145: 'M_VRGN', 146: 'B_RCYL', 147: 'B_VRGN', 148: 'ALL'}, 'biomass - domestic wood feedstocks': {46: 'MRESUS', 47: 'MRESUU_ST', 48: 'UWDWCD_ST', 49: 'UWDWMS_ST', 50: 'LOGI', 51: 'LOGO', 52: 'LOGP', 53: 'LOGTOF', 54: 'WOODY', 55: 'FUELWOOD', 56: 'MILL RESIDUE', 57: 'PULPING LIQUORS', 58: 'MSW SOURCES-FOREST'}, 'air conditioning type': {64: 'ROOM', 63: 'CENTRAL'}, 'AEO cement industry throughput categories': {149: 'GRIND', 150: 'DRY', 151: 'WET', 152: 'LIME', 153: 'DRY-BAL', 154: 'ALL'}, 'final energy': {}, 'total': {1: 'TOTAL'}, 'biomass - domestic corn feedstocks': {59: 'ETHANOL (CORN)'}, 'building types': {17: 'ASSEMBLY', 18: 'EDUCATION', 19: 'FOOD SALES', 20: 'FOOD SERVICE', 21: 'HEALTH', 22: 'LODGING', 23: 'MERC/SERVICE', 24: 'OFFICE-LARGE', 25: 'OFFICE-SMALL', 26: 'OTHER', 27: 'WAREHOUSE'}, 'supply_node': {1: 'HYDROGEN BLEND', 2: 'PIPELINE GAS BLEND', 3: 'DIESEL BLEND', 4: 'GASOLINE BLEND', 5: 'JET FUEL BLEND', 6: 'BULK ELECTRICITY BLEND', 8: 'ONSHORE WIND', 9: 'OFFSHORE WIND', 10: 'ROOFTOP SOLAR PV', 11: 'DISTRIBUTION-SITED SOLAR PV', 12: 'TRANSMISSION-SITED SOLAR PV', 13: 'NUCLEAR POWER PLANTS', 14: 'COMBINED-CYCLE GAS TURBINES', 15: 'COAL POWER PLANTS', 16: 'COMBUSTION TURBINES', 17: 'GEOTHERMAL POWER PLANTS', 18: 'COMBINED-CYCLE GAS TURBINES W/CCS', 19: 'COAL POWER PLANTS WITH CCS', 20: 'RUN OF RIVER HYDROELECTRIC POWER PLANTS', 21: 'DISPATCHABLE HYDROELECTRIC POWER PLANTS', 22: 'HYDROGEN ELECTROLYSIS - CENTRAL STATION', 23: 'HYDROGEN GAS REFORMATION WITH CCS - CENTRAL STATION', 24: 'RENEWABLE DIESEL PRODUCTION FACILITIES', 25: 'GAS COMPRESSION AND FUELING STATIONS', 26: 'LIQUEFIED GAS FUELING STATION', 27: 'COMBINED HEAT AND POWER', 28: 'POWER-TO-GAS PRODUCTION FACILITIES', 29: 'BOMASS GASIFICATION FACILITIES', 30: 'RENEWABLE JET-FUEL PRODUCTION FACILITIES', 31: 'ETHANOL PRODUCTION FACILTIES', 32: 'ELECTRICITY DISTRIBUTION GRID', 33: 'ELECTRICITY TRANSMISSION GRID', 34: 'STEAM BLEND', 35: 'GAS DISTRIBUTION PIPELINE', 36: 'GAS TRANSMISSION PIPELINE', 38: 'URANIUM IMPORT', 40: 'COAL IMPORT', 41: 'COKE IMPORT', 42: 'REFINED FOSSIL DIESEL PRODUCT', 43: 'REFINED FOSSIL GASOLINE PRODUCT', 44: 'REFINED FOSSIL KEROSENE PRODUCT', 45: 'REFINED FOSSIL JET FUEL PRODUCT', 46: 'REFINED FOSSIL LPG PRODUCT', 47: 'LUBRICANTS IMPORT', 48: 'PETROLEUM COKE IMPORT', 49: 'OTHER PETROLEUM IMPORT', 51: 'STILL GAS IMPORT', 52: 'RESIDUAL FOSSIL FUEL OIL PRODUCT', 53: 'NATURAL GAS BLEND', 54: 'HYDRO PRIMARY', 55: 'GEOTHERMAL PRIMARY', 56: 'COAL PRIMARY - DOMESTIC', 57: 'WIND PRIMARY', 58: 'SOLAR PRIMARY', 59: 'BIOMASS PRIMARY - DOMESTIC NON-WOODY CELLULOSIC', 60: 'NATURAL GAS PRIMARY - DOMESTIC', 61: 'BULK ELECTRICITY STORAGE', 62: 'DISTRIBUTED STORAGE', 64: 'OIL BLEND', 65: 'RENEWABLE PIPELINE GAS PRODUCT', 67: 'BIOMASS PRIMARY - DOMESTIC PULPING LIQUORS', 68: 'THERMAL DISPATCH BLEND', 70: 'OIL PRIMARY - DOMESTIC', 71: 'BIOMASS PRIMARY - INTERNATIONAL', 72: 'OIL PRIMARY - INTERNATIONAL', 73: 'PETROLEUM REFINERIES', 74: 'BIOMASS PRIMARY - DOMESTIC MANURE', 75: 'BIOMASS PRIMARY - DOMESTIC WOOD', 76: 'BIOMASS PRIMARY - DOMESTIC LIPID', 77: 'BIOMASS PRIMARY - DOMESTIC CORN', 78: 'SOLAR - THERMO HYDROGEN PRODUCTION FACILITIES -CENTRAL STATION', 79: 'PIPELINE GAS LIQUEFACTION FACILITIES', 80: 'HYDROGEN FUELING STATIONS', 81: 'LIQUID HYDROGEN TRUCK DELIVERY', 83: 'MOTOR GASOLINE END-USE DELIVERY', 84: 'DIESEL END-USE DELIVERY', 86: 'RESIDUAL FUEL-OIL END-USE DELIVERY', 87: 'COAL - END-USE DELIVERY', 88: 'COAL  - RAIL DELIVERY', 89: 'ANAEROBIC DIGESTERS - LIGNOCELLULOSIC ', 90: 'ANAEROBIC DIGESTERS - MANURE', 91: 'OTHER FOSSIL STEAM TURBINES', 92: 'BIOMASS POWER PLANTS', 93: 'INDUSTRIAL BOILERS', 94: 'NATURAL GAS - INTERNATIONAL', 95: 'NAPTHA', 96: 'FUEL CELL POWER PLANTS', 97: 'SOLAR THERMAL POWER PLANTS', 98: 'DISTRIBUTED ELECTRICITY', 99: 'ETHANOL BLEND', 100: 'ETHANOL PRODUCT - INTERNATIONAL', 101: 'COAL BLEND'}, 'Process-Specific Industry End-Uses': {128: 'HVAC', 129: 'SUPPORT', 130: 'TRANSPORT', 131: 'PROCESS', 127: 'LIGHTING'}, 'technology': {4: 'REFERENCE AIR SOURCE HEAT PUMP - HEATING', 5: 'REFERENCE DISTILLATE FURNACE', 6: 'REFERENCE DISTILLATE BOILER/RADIATOR', 7: 'REFERENCE ELECTRIC UNIT HEATERS', 8: 'REFERENCE NATURAL GAS BOILER/RADIATOR', 9: 'REFERENCE LPG FURNACE', 10: 'REFERENCE GEOTHERMAL HEAT PUMP - HEATING', 11: 'CORDWOOD STOVES', 12: 'REFERENCE KEROSENE FURNACE', 13: 'REFERENCE NATURAL GAS FURNACE', 14: 'HIGH EFFICIENCY AIR SOURCE HEAT PUMP - HEATING', 15: 'HIGH EFFICIENCY NATURAL GAS FURNACE', 16: 'HIGH EFFICIENCY NATURAL GAS BOILER/RADIATOR', 17: 'HIGH EFFICIENCY KEROSENE FURNACE', 18: 'HIGH EFFICIENCY LPG FURNACE', 19: 'HIGH EFFICIENCY DISTILLATE FURNACE', 20: 'HIGH EFFICIENCY DISTILLATE BOILER/RADIATOR', 21: 'HIGH EFFICIENCY GEOTHERMAL HEAT PUMP - HEATING', 22: 'INCANDESCENT GSL', 23: 'CFL GSL', 24: 'LED GSL', 25: 'REFERENCE MEDIUM - DUTY DIESEL VEHICLE', 26: 'REFERENCE MEDIUM-DUTY GASOLINE VEHICLE', 27: 'REFERENCE MEDIUM-DUTY CNG VEHICLE', 28: 'COMMERCIAL ELECTRIC BOILER', 29: 'REFERENCE GAS WATER HEATER', 30: 'HIGH EFFICIENCY GAS WATER HEATER', 31: 'REFERENCE DISTILLATE WATER HEATER', 32: 'HIGH EFFICIENCY DISTILLATE WATER HEATER', 33: 'REFERENCE LPG WATER HEATER', 34: 'HIGH EFFICIENCY LPG WATER HEATER', 35: 'REFERENCE ELECTRIC RESISTANCE WATER HEATER', 36: 'REFERENCE ELECTRIC HEAT PUMP WATER HEATER', 37: 'HIGH EFFICIENCY ELECTRIC HEAT PUMP WATER HEATER', 38: 'SOLAR WATER HEATER WITH ELECTRIC BACKUP', 39: 'HIGH EFFICIENCY ELECTRIC RESISTANCE WATER HEATER', 40: 'REFERENCE INSTANTANEOUS GAS WATER HEATER', 41: 'HIGH EFFICIENCY INSTANTANEOUS GAS WATER HEATER', 42: 'REFERENCE CENTRAL AIR CONDITIONER ', 43: 'HIGH EFFICIENCY CENTRAL AIR CONDITIONER', 44: 'REFERENCE AIR SOURCE HEAT PUMP - COOLING', 45: 'REFERENCE GEOTHERMAL HEAT PUMP - COOLING', 46: 'HIGH EFFICIENCY AIR SOURCE HEAT PUMP - COOLING', 47: 'HIGH EFFICIENCY GEOTHERMAL HEAT PUMP - COOLING', 48: 'REFERENCE TOP MOUNT REFRIGERATOR', 49: 'HIGH EFFICIENCY TOP MOUNT REFRIGERATOR', 50: 'REFERENCE BOTTOM MOUNT REFRIGERATOR', 51: 'HIGH EFFICIENCY BOTTOM MOUNT REFRIGERATOR', 52: 'REFERENCE SIDE MOUNT REFRIGERATOR', 53: 'HIGH EFFICIENCY SIDE MOUNT REFRIGERATOR', 54: 'REFERENCE UPRIGHT FREEZER', 55: 'HIGH EFFICIENCY UPRIGHT FREEZER', 56: 'REFERENCE CHEST FREEZER', 57: 'HIGH EFFICIENCY CHEST FREEZER', 58: 'REFERENCE GAS COOKTOP/STOVE', 59: 'ELECTRIC COOKTOP/STOVE', 60: 'HIGH EFFICIENCY GAS COOKTOP/STOVE', 61: 'REFERENCE CLOTHES WASHER - FRONT LOADING', 62: 'HIGH EFFICIENCY CLOTHES WASHER - FRONT LOADING', 63: 'REFERENCE CLOTHES WASHER - TOP LOADING', 64: 'HIGH EFFICIENCY CLOTHES WASHER - TOP LOADING', 65: 'REFERENCE ELECTRIC CLOTHES DRYER', 66: 'HIGH EFFICIENCY ELECTRIC CLOTHES DRYER', 67: 'REFERENCE GAS CLOTHES DRYER', 68: 'HIGH EFFICIENCY GAS CLOTHES DRYER', 69: 'REFERENCE DISHWASHER', 70: 'HIGH EFFICIENCY DISHWASHER', 71: 'REFERENCE NATURAL GAS HEAT PUMP  - HEATING', 72: 'REFERENCE NATURAL GAS HEAT PUMP  - COOLING', 73: 'REFERENCE ROOM AIR CONDITIONER', 74: 'HIGH EFFICIENCY ROOM AIR CONDITIONER', 75: 'REFERENCE COMMERCIAL ELECTRIC BOOSTER WATER HEATER', 76: 'REFERENCE LPG COOKTOP/STOVE', 77: 'INCANDESCENT REFLECTOR', 78: 'CFL REFLECTOR', 79: 'HALOGEN REFLECTOR', 80: 'LFD REFLECTOR', 81: 'T-12 LINEAR FLUORESCENT', 82: 'T-8 LINEAR FLUORESCENT', 83: 'LED LINEAR FLUORESCENT', 84: 'LED EXTERIOR', 85: 'HID EXTERIOR', 86: 'CFL EXTERIOR', 87: 'INCANDESCENT EXTERIOR', 88: 'REFERENCE COMMERCIAL GAS FURNACE', 89: 'HIGH EFFICIENCY COMMERCIAL GAS FURNACE', 90: 'REFERENCE COMMERCIAL DISTILLATE FURNACE', 91: 'REFERENCE COMMERCIAL AIR SOURCE HEAT PUMP - COOLING', 92: 'REFERENCE COMMERCIAL GAS BOILER', 93: 'HIGH EFFICIENCY COMMERCIAL GAS BOILER', 94: 'REFERENCE COMMERCIAL DISTILLATE BOILER', 95: 'HIGH EFFICIENCY COMMERCIAL DISTILLATE BOILER', 96: 'REFERENCE COMMERCIAL AIR SOURCE HEAT PUMP - HEATING', 97: 'HIGH EFFICIENCY COMMERCIAL AIR SOURCE HEAT PUMP - HEATING', 98: 'REFERENCE COMMERCIAL GAS HEAT PUMP - HEATING', 99: 'HIGH EFFICIENCY COMMERCIAL AIR SOURCE HEAT PUMP - COOLING', 100: 'REFERENCE COMMERCIAL GAS HEAT PUMP - COOLING', 101: 'ELECTRIC RESISTANCE HEAT', 102: 'REFERENCE COMMERCIAL GROUND SOURCE HEAT PUMP - HEATING', 103: 'HIGH EFFICIENCY COMMERCIAL GROUND SOURCE HEAT PUM- HEATING', 104: 'ELECTRIC BOILER', 105: 'REFERENCE COMMERCIAL GROUND SOURCE HEAT PUMP -COOLING', 106: 'HIGH EFFICIENCY COMMERCIAL GROUND SOURCE HEAT PUM- COOLING', 107: 'REFERENCE SCROLL CHILLER', 108: 'HIGH EFFICIENCY SCROLL CHILLER', 109: 'REFERENCE SCREW CHILLER', 110: 'HIGH EFFICIENCY SCREW CHILLER', 111: 'REFERENCE RECIPROCATING CHILLER', 112: 'HIGH EFFICIENCY RECIPROCATING CHILLER', 113: 'REFERENCE CENTRIFUGAL CHILLER', 114: 'HIGH EFFICIENCY CENTRIFUGAL CHILLER', 115: 'REFERENCE ROOFTOP AIR CONDITIONER', 116: 'HIGH EFFICIENCY ROOFTOP AIR CONDITIONER', 117: 'REFERENCE WALL/ROOM AIR CONDITIONER', 118: 'HIGH EFFICIENCY WALL/ROOM AIR CONDITIONER', 119: 'REFERENCE COMMERCIAL CENTRAL AIR CONDITIONER', 120: 'HIGH EFFICIENCY COMMERCIAL CENTRAL AIR CONDITIONER', 121: 'REFERENCE COMMERCIAL GAS ABSORPTION CHILLER', 122: 'REFERENCE COMMERCIAL GAS ENGINE-DRIVEN CHILLER', 123: 'REFERENCE GAS-DRIVEN AC', 124: 'REFERENCE CONSTANT AIR COMMERCIAL VENTILATION SYSTEM', 125: 'HIGH EFFICIENCY CONSTANT AIR COMMERCIAL VENTILATION SYSTEM', 126: 'REFERENCE VARIABLE AIR COMMERCIAL VENTILATION SYSTEM', 127: 'HIGH EFFICIENCY VARIABLE AIR COMMERCIAL VENTILATION SYSTEM', 128: 'RANGE, ELECTRIC, 4 BURNER, OVEN, 11" GRIDDLE   ', 129: 'RANGE, ELECTRIC-INDUCTION, 4 BURNER, OVEN, 11" GRIDDLE', 130: 'RANGE, GAS, 4 BURNER, OVEN, 11" GRIDDLE      ', 131: 'RANGE, GAS, 4 POWERED BURNERS, CONVECT. OVEN, 11" GRIDDLE', 132: 'COMMERCIAL GENERAL SERVICE INCANDESCENT LAMP', 133: 'COMMERCIAL COMPACT FLUORESCENT LAMP', 134: 'REFERENCE COMMERCIAL HALOGEN PAR38', 135: 'HIGH EFFICIENCY COMMERCIAL HALOGEN INFRARED REFLECTOR PAR38', 136: 'REFERENCE COMMERCIAL HALOGEN EDISON A-LINE LAMP', 137: 'LED EDISON SOCKET SUBSTITUTE', 138: 'REFERENCE COMMERCIAL 4 FT. T8', 139: 'HIGH EFFICIENCY COMMERCIAL 4 FT. T8', 140: 'HIGH EFFICIENCY COMMERCIAL 4 FT. T8 W/ OCCUPANCE SENSOR', 141: 'HIGH EFFICIENCY COMMERCIAL 4 FT. T8 W/ SPECULAR REFLECTOR', 142: 'HIGH EFFICIENCY COMMERCIAL 4 FT. T8 W/ OCCUPANCY SENSOR AND SPECULAR REFLECTOR', 143: 'REFERENCE COMMERCIAL <4 FT. T8', 144: 'REFERENCE COMMERCIAL 4 -FT T5', 145: 'LED 4 FT. LINEAR FLUORESCENT SUBSTITUTE', 146: 'REFERENCE COMMERCIAL 8 FT. T12', 147: 'REFERENCE COMMERCIAL 8 FT. T8', 148: 'HIGH EFFICIENCY COMMERCIAL 8 FT. T8', 149: 'REFERENCE COMMERCIAL HIGH OUTPUT 8 FT. T8', 151: 'REFERENCE COMMERCIAL MERCURY VAPOR LOW-BAY LIGHTING', 152: 'REFERENCE COMMERCIAL METAL HALIDE LOW-BAY LIGHTING', 154: 'REFERENCE COMMERCIAL HIGH PRESSURE SODIUM LOW-BAY LIGHTING', 155: 'LED LOW-BAY LIGHTING SUBSTITUTE', 156: 'REFERENCE COMMERCIAL HIGH OUTPUT T5 HIGH - BAY LIGHTING', 158: 'LED HIGH-BAY LIGHTING', 160: 'REFERENCE COMMERCIAL MERCURY VAPOR HIGH BAY', 161: 'REFERENCE COMMERCIAL METAL HALIDE HIGH BAY', 163: 'REFERENCE COMMERCIAL HIGH PRESSURE SODIUM HIGH BAY', 164: 'HIGH EFFICIENCY COMMERCIAL HIGH PRESSURE SODIUM HIGH BAY', 165: 'REFERENCE SUPERMARKET DISPLAY CASES', 166: 'HIGH EFFICIENCY SUPERMARKET DISPLAY CASES', 176: 'REFERENCE COMMERCIAL COMPRESSOR RACK SYSTEMS', 177: 'HIGH EFFICIENCY COMMERCIAL COMPRESSOR RACK SYSTEMS', 178: 'REFERENCE COMMERCIAL CONDENSERS', 179: 'HIGH EFFICIENCY COMMERCIAL CONDENSERS', 180: 'REFERENCE COMMERCIAL WALK-IN REFRIGERATORS', 181: 'HIGH EFFICIENCY COMMERCIAL WALK-IN REFRIGERATORS', 182: 'REFERENCE COMMERCIAL WALK-IN FREEZERS', 183: 'HIGH EFFICIENCY COMMERCIAL WALK-IN FREEZERS', 184: 'REFERENCE COMMERCIAL REACH-IN REFRIGERATORS', 185: 'HIGH EFFICIENCY COMMERCIAL REACH-IN REFRIGERATORS', 186: 'REFERENCE COMMERCIAL REACH-IN FREEZERS', 187: 'HIGH EFFICIENCY COMMERCIAL RECH-IN FREEZERS', 188: 'REFERENCE COMMERCIAL ICE-MACHINES', 189: 'HIGH EFFICIENCY COMMERCIAL ICE-MACHINGS', 190: 'REFERENCE COMMERCIAL BEVERAGE MERCHANDISERS', 191: 'HIGH EFFICIENCY COMMERCIAL BEVERAGE MERCHANDISERS', 192: 'REFERENCE COMMERCIAL REFRIGERATED VENDING MACHINES', 193: 'HIGH EFFICIENCY COMMERCIAL REFRIGERATED VENDING MACHINES', 194: 'COMMERCIAL ELECTRIC BOOSTER WATER HEATER', 195: 'COMMERCIAL SOLAR WATER HEATER WITH ELECTRIC BACKUP', 196: 'COMMERCIAL REFERENCE HEAT PUMP STORAGE WATER HEATER', 197: 'COMMERCIAL HIGH EFFICIENCY HEAT PUMP STORAGE WATER HEATER', 198: 'COMMERCIAL REFERENCE GAS INSTANTANEOUS WATER HEATER', 199: 'COMMERCIAL HIGH EFFICIENCY GAS INSTANTANEOUS WATER HEATER', 200: 'COMMERCIAL HIGH EFFICIENCY GAS BOOSTER WATER HEATER', 201: 'COMMERCIAL  REFERENCE GAS BOOSTER WATER HEATER', 202: 'COMMERCIAL REFERENCE GAS STORAGE WATER HEATER', 203: 'COMMERCIAL HIGH EFFICIENCY GAS STORAGE WATER HEATER', 204: 'COMMERCIAL ELECTRIC RESISTANCE STORAGE WATER HEATER', 205: 'COMMERCIAL REFERENCE OIL WATER HEATER', 206: 'COMMERCIAL HIGH EFFICIENCY OIL WATER HEATER', 207: 'REFERENCE LPG MEDIUM-DUTY VEHICLE', 208: 'HYDRBID GASOLINE MEDIUM-DUTY VEHICLE', 209: 'HYBRID CNG MEDIUM-DUTY VEHICLE', 210: 'HYDROGEN FUEL CELL MEDIUM-DUTY VEHICLE', 211: 'BATTERY ELECTRIC MEDIUM-DUTY VEHICLE', 212: 'REFERENCE DIESEL HEAVY-DUTY VEHICLE', 213: 'DIESEL HYBRID HEAVY-DUTY VEHICLE', 214: 'LNG HEAVY-DUTY VEHICLE', 215: 'LNG HYBRID HEAVY-DUTY VEHICLE', 216: 'HYDROGEN FCV HEAVY-DUTY VEHICLE', 217: 'REFERENCE GASOLINE HEAVY-DUTY VEHICLE', 218: 'REFERENCE PROPANE HEAVY-DUTY VEHICLE', 220: 'REFERENCE 4 FT. T12 ', 221: 'REFERENCE GASOLINE LIGHT-DUTY AUTO', 222: 'ELECTRIC LIGHT-DUTY AUTO ', 224: 'PHEV - 80 MILE RANGE - LIGHT DUTY AUTO', 225: 'PHEV - GASOLINE - 40 MILE RANGE - LIGHT DUTY AUTO', 226: 'CNG LIGHT-DUTY AUTO', 227: 'PROPANE ICE LIGHT-DUTY AUTO', 228: 'HYDROGEN FUEL-CELL LIGHT-DUTY AUTO', 229: 'DIESEL - ELECTRIC HYBRID LIGHT-DUTY AUTO', 230: 'GASOLINE-ELECTRIC HYBRID LIGHT-DUTY AUTO', 231: 'REFERENCE TDI LIGHT-DUTY AUTO', 232: 'REFERENCE GASOLINE LIGHT-DUTY TRUCK', 233: 'ELECTRIC LIGHT-DUTY TRUCK', 234: 'PHEV - GASOLINE -  80 MILE RANGE  - LIGHT DUTY TRUCK', 235: 'PHEV - GASOLINE - 40 MILE RANGE - LIGHT DUTY TRUCK', 236: 'CNG LIGHT-DUTY TRUCK', 237: 'PROPANE ICE LIGHT-DUTY TRUCK', 238: 'HYDROGEN FUEL-CELL LIGHT-DUTY TRUCK', 239: 'ELECTRIC - DIESEL HYBRID LIGHT-DUTY TRUCK', 240: 'ELECTRIC - GASOLINE HYBRID LIGHT-DUTY TRUCK', 241: 'REFERENCE TDI LIGHT-DUTY TRUCK', 242: 'REFERENCE FLEX FUEL LIGHT-DUTY AUTO', 243: 'REFERENCE FLEX-FUEL LIGHT-DUTY TRUCK'}, 'Industry End-Uses': {132: 'LIGHTING', 133: 'HVAC', 134: 'SUPPORT', 135: 'TRANSPORT', 136: 'HEAT', 137: 'REFRIGERATION', 138: 'MACHINE DRIVE', 139: 'ELECTRO-CHEMICAL PROCESSES', 140: 'OTHER', 141: 'FEEDSTOCKS'}, 'agricultural end-uses': {104: 'IRRIGATION', 105: 'TRANSPORTATION', 106: 'OTHER'}, 'AEO paper industry throughput categories': {119: 'PAPER_M', 120: 'BLEACH', 121: 'WASTE_P', 122: 'MECH_P', 123: 'CHEM_P', 124: 'KRAFT_P', 125: 'WOOD', 126: 'ALL'}, 'residential secondary heat': {82: 'GAS 2ND HEAT', 83: 'ELECTRIC 2ND HEAT', 84: 'DISTILLATE 2ND HEAT', 85: 'LPG 2ND HEAT', 86: 'KEROSENE 2ND HEAT', 87: 'COAL 2ND HEAT', 88: 'WOOD 2ND HEAT'}, 'medium duty truck class': {97: 'CLASS 3', 98: 'CLASS 4-6'}, 'commuter rail modes': {176: 'COMMUTER', 174: 'INTERCITY', 175: 'TRANSIT'}, 'housing types': {28: 'SINGLE-FAMILY', 29: 'MULTI-FAMILY', 30: 'MOBILE HOME'}, 'supply_node_export': {1: 'HYDROGEN BLEND EXPORT', 2: 'PIPELINE GAS BLEND EXPORT', 3: 'DIESEL BLEND EXPORT', 4: 'GASOLINE BLEND EXPORT', 5: 'JET FUEL BLEND EXPORT', 6: 'BULK ELECTRICITY BLEND EXPORT', 8: 'ONSHORE WIND EXPORT', 9: 'OFFSHORE WIND EXPORT', 10: 'ROOFTOP SOLAR PV EXPORT', 11: 'DISTRIBUTION-SITED SOLAR PV EXPORT', 12: 'TRANSMISSION-SITED SOLAR PV EXPORT', 13: 'NUCLEAR POWER PLANTS EXPORT', 14: 'COMBINED-CYCLE GAS TURBINES EXPORT', 15: 'COAL POWER PLANTS EXPORT', 16: 'COMBUSTION TURBINES EXPORT', 17: 'GEOTHERMAL POWER PLANTS EXPORT', 18: 'COMBINED-CYCLE GAS TURBINES W/CCS EXPORT', 19: 'COAL POWER PLANTS WITH CCS EXPORT', 20: 'RUN OF RIVER HYDROELECTRIC POWER PLANTS EXPORT', 21: 'DISPATCHABLE HYDROELECTRIC POWER PLANTS EXPORT', 22: 'HYDROGEN ELECTROLYSIS - CENTRAL STATION EXPORT', 23: 'HYDROGEN GAS REFORMATION WITH CCS - CENTRAL STATION EXPORT', 24: 'RENEWABLE DIESEL PRODUCTION FACILITIES EXPORT', 25: 'GAS COMPRESSION AND FUELING STATIONS EXPORT', 26: 'LIQUEFIED GAS FUELING STATION EXPORT', 27: 'COMBINED HEAT AND POWER EXPORT', 28: 'POWER-TO-GAS PRODUCTION FACILITIES EXPORT', 29: 'BOMASS GASIFICATION FACILITIES EXPORT', 30: 'RENEWABLE JET-FUEL PRODUCTION FACILITIES EXPORT', 31: 'ETHANOL PRODUCTION FACILTIES EXPORT', 32: 'ELECTRICITY DISTRIBUTION GRID EXPORT', 33: 'ELECTRICITY TRANSMISSION GRID EXPORT', 34: 'STEAM BLEND EXPORT', 35: 'GAS DISTRIBUTION PIPELINE EXPORT', 36: 'GAS TRANSMISSION PIPELINE EXPORT', 38: 'URANIUM IMPORT EXPORT', 40: 'COAL IMPORT EXPORT', 41: 'COKE IMPORT EXPORT', 42: 'REFINED FOSSIL DIESEL PRODUCT EXPORT', 43: 'REFINED FOSSIL GASOLINE PRODUCT EXPORT', 44: 'REFINED FOSSIL KEROSENE PRODUCT EXPORT', 45: 'REFINED FOSSIL JET FUEL PRODUCT EXPORT', 46: 'REFINED FOSSIL LPG PRODUCT EXPORT', 47: 'LUBRICANTS IMPORT EXPORT', 48: 'PETROLEUM COKE IMPORT EXPORT', 49: 'OTHER PETROLEUM IMPORT EXPORT', 51: 'STILL GAS IMPORT EXPORT', 52: 'RESIDUAL FOSSIL FUEL OIL PRODUCT EXPORT', 53: 'NATURAL GAS BLEND EXPORT', 54: 'HYDRO PRIMARY EXPORT', 55: 'GEOTHERMAL PRIMARY EXPORT', 56: 'COAL PRIMARY - DOMESTIC EXPORT', 57: 'WIND PRIMARY EXPORT', 58: 'SOLAR PRIMARY EXPORT', 59: 'BIOMASS PRIMARY - DOMESTIC NON-WOODY CELLULOSIC EXPORT', 60: 'NATURAL GAS PRIMARY - DOMESTIC EXPORT', 61: 'BULK ELECTRICITY STORAGE EXPORT', 62: 'DISTRIBUTED STORAGE EXPORT', 64: 'OIL BLEND EXPORT', 65: 'RENEWABLE PIPELINE GAS PRODUCT EXPORT', 67: 'BIOMASS PRIMARY - DOMESTIC PULPING LIQUORS EXPORT', 68: 'THERMAL DISPATCH BLEND EXPORT', 70: 'OIL PRIMARY - DOMESTIC EXPORT', 71: 'BIOMASS PRIMARY - INTERNATIONAL EXPORT', 72: 'OIL PRIMARY - INTERNATIONAL EXPORT', 73: 'PETROLEUM REFINERIES EXPORT', 74: 'BIOMASS PRIMARY - DOMESTIC MANURE EXPORT', 75: 'BIOMASS PRIMARY - DOMESTIC WOOD EXPORT', 76: 'BIOMASS PRIMARY - DOMESTIC LIPID EXPORT', 77: 'BIOMASS PRIMARY - DOMESTIC CORN EXPORT', 78: 'SOLAR - THERMO HYDROGEN PRODUCTION FACILITIES -CENTRAL STATION EXPORT', 79: 'PIPELINE GAS LIQUEFACTION FACILITIES EXPORT', 80: 'HYDROGEN FUELING STATIONS EXPORT', 81: 'LIQUID HYDROGEN TRUCK DELIVERY EXPORT', 83: 'MOTOR GASOLINE END-USE DELIVERY EXPORT', 84: 'DIESEL END-USE DELIVERY EXPORT', 86: 'RESIDUAL FUEL-OIL END-USE DELIVERY EXPORT', 87: 'COAL - END-USE DELIVERY EXPORT', 88: 'COAL  - RAIL DELIVERY EXPORT', 89: 'ANAEROBIC DIGESTERS - LIGNOCELLULOSIC  EXPORT', 90: 'ANAEROBIC DIGESTERS - MANURE EXPORT', 91: 'OTHER FOSSIL STEAM TURBINES EXPORT', 92: 'BIOMASS POWER PLANTS EXPORT', 93: 'INDUSTRIAL BOILERS EXPORT', 94: 'NATURAL GAS - INTERNATIONAL EXPORT', 95: 'NAPTHA EXPORT', 96: 'FUEL CELL POWER PLANTS EXPORT', 97: 'SOLAR THERMAL POWER PLANTS EXPORT', 98: 'DISTRIBUTED ELECTRICITY EXPORT', 99: 'ETHANOL BLEND EXPORT', 100: 'ETHANOL PRODUCT - INTERNATIONAL EXPORT', 101: 'COAL BLEND EXPORT'}, 'residential lighting category': {96: 'EXTERIOR', 93: 'GENERAL SERVICE LAMPS', 94: 'REFLECTORS', 95: 'LINEAR FLUORESCENTS'}, 'AEO aluminum industry throughput categories': {163: 'SEMI_SHEET', 164: 'SEMI_OTHER', 165: 'SECONDARY', 166: 'PRIMARY', 167: 'BAUXITE', 168: 'ALL'}, 'subsector': {1: 'WATER HEATING', 2: 'SPACE HEATING', 3: 'AIR CONDITIONING', 4: 'GENERAL SERVICE LIGHTING', 5: 'REFRIGERATION', 6: 'COOKING', 7: 'VENTILATION', 8: 'OFFICE EQUIPMENT (P.C.)', 9: 'OFFICE EQUIPMENT (NON-P.C.)', 10: 'OTHER', 11: 'AGRICULTURE-CROPS', 12: 'AGRICULTURE-OTHER', 15: 'METAL AND OTHER NON-METALLIC MINING', 16: 'CONSTRUCTION', 17: 'FOOD AND KINDRED PRODUCTS', 18: 'PAPER AND ALLIED PRODUCTS', 19: 'BULK CHEMICALS', 20: 'GLASS AND GLASS PRODUCTS', 21: 'CEMENT', 22: 'IRON AND STEEL ', 23: 'ALUMINUM INDUSTRY', 24: 'FABRICATED METAL PRODUCTS', 25: 'MACHINERY', 26: 'COMPUTER AND ELECTRONIC PRODUCTS', 27: 'TRANSPORTATION EQUIPMENT', 28: 'ELECTRICAL EQUIP., APPLIANCES, AND COMPONENTS', 29: 'WOOD PRODUCTS', 30: 'PLASTIC AND RUBBER PRODUCTS', 31: 'BOM-OTHER', 33: 'WATER HEATING', 34: 'SPACE HEATING', 35: 'AIR CONDITIONING', 36: 'OTHER - ELECTRIC', 37: 'LIGHTING', 38: 'CLOTHES WASHING', 39: 'CLOTHES DRYING', 40: 'DISHWASHING', 41: 'RESIDENTIAL REFRIGERATION', 42: 'RESIDENTIAL FREEZING', 43: 'RESIDENTIAL COOKING', 44: 'SECONDARY HEATING', 45: 'OTHER APPLIANCES', 46: 'FURNACE FANS', 48: 'LINEAR FLUORESCENT LIGHTING', 49: 'HIGH INTENSITY DISCHARGE LIGHTING', 64: 'MEDIUM DUTY TRUCKS', 65: 'HEAVY DUTY TRUCKS', 66: 'BUSES', 67: 'PASSENGER RAIL', 68: 'FREIGHT RAIL', 69: 'AVIATION', 70: 'DOMESTIC SHIPPING', 71: 'MILITARY USE', 72: 'LIGHT DUTY AUTOS', 73: 'LIGHT DUTY TRUCKS', 75: 'MOTORCYCLES', 77: 'LUBRICANTS', 78: 'INTERNATIONAL SHIPPING', 79: 'RECREATIONAL BOATS'}, 'biomass - domestic cellulosic feedstocks': {32: 'CGT', 33: 'CR', 34: 'OVP', 35: 'RH', 36: 'RS', 37: 'SCT', 38: 'WD', 39: 'BARLEY-STRW', 40: 'CORN-STVR', 41: 'OATS-STRW', 42: 'SORGHUM-STBL', 43: 'WHEAT-STRW', 44: 'ANNLENGYCRP', 45: 'PERNGRASS', 31: 'MSW SOURCES-AG'}, 'AEO steel  industry throughput categories': {160: 'EAF', 161: 'COKE', 162: 'ALL', 155: 'COLD_RL', 156: 'HOT_RL', 157: 'INGOT', 158: 'CONTIN', 159: 'BF/BOF'}, 'biomass - domestic manure feedstocks': {62: 'M'}, 'other residential appliances': {89: 'ELECTRIC OTHER APPLIANCES', 90: 'NATURAL GAS APPLIANCES', 91: 'LPG APPLIANCES', 92: 'DISTILLATE APPLIANCES'}, 'end uses': {2: 'BUILDINGS - OTHER', 3: 'BUILDINGS - TRANSPORT', 4: 'IRRIGATION', 5: 'UNDIFFERENTIATED USE, APPLIES TO ALL MINING INDUSTRIES, CONSTRUCTION AND REFINING', 6: 'BUILDINGS - LIGHTING', 7: 'BUILDINGS - HVAC', 8: 'BUILDINGS - SUPPORT', 9: 'PROCCESS - HEAT', 10: 'PROCCESS - REFRIG', 11: 'PROCESS - MACHDRV', 12: 'PROCESS - ELECTRO', 13: 'PROCESS - OTHER', 14: 'PROCESS - AGGREGATED, APPLIES TO PAPER, CEMENT, FE & STEEL, GLASS AND AL ', 15: 'PROCESS - FEEDSTOCK', 16: 'STEAM'}, 'light duty truck class': {102: 'LIGHT TRUCKS', 103: 'LIGHT COMMERCIAL TRUCKS'}, 'AEO Chemical Process Subset': {169: 'INORGANIC', 170: 'ORGANIC', 171: 'RESINSYNTH', 172: 'AGRICHEM', 173: 'ALL'}, 'us': {65: 'US'}, 'biomass - domestic lipid feedstocks': {60: 'BIODIESEL (WASTE)', 61: 'BIODIESEL (SOYBEANS)'}, 'ghg': {1: 'CO2', 2: 'CH4', 3: 'N2O'}, 'miscellaneous residential loads': {65: 'TELEVISIONS', 66: 'SET-TOP BOXES', 67: 'HOME THEATER SYSTEMS', 68: 'DVD PLAYERS', 69: 'VIDEO GAME CONSOLES', 70: 'PC DESKTOPS', 71: 'PC LAPTOPS', 72: 'PC MONITORS', 73: 'NETWORK EQUIPMENT', 74: 'RECHARGEABLE DEVICES', 75: 'CEILING FANS', 76: 'COFFEE MACHINES', 77: 'DEHUMIDIFIERS', 78: 'MICROWAVES', 79: 'POOL HEATERS AND PUMPS', 80: 'SECURITY SYSTEMS', 81: 'SPAS'}, 'us_supply': {65: 'US'}, 'final_energy': {1: 'GASOLINE FUEL', 2: 'ELECTRICITY', 3: 'DIESEL FUEL', 4: 'PIPELINE GAS', 5: 'LPG FUEL', 6: 'BIOMASS - WOOD', 7: 'KEROSENE FUEL', 8: 'RESIDUAL FUEL OIL', 9: 'COMPRESSED PIPELINE GAS', 10: 'SOLAR ', 11: 'COAL', 12: 'LIQUID HYDROGEN', 13: 'LIQUEFIED PIPELINE GAS', 14: 'JET FUEL', 16: 'OTHER PETROLEUM', 17: 'ON-SITE HYDROPOWER', 18: 'STEAM', 19: 'PETROLEUM COKE', 21: 'BIOMASS-CELLULOSIC', 24: 'BIOMASS - MANURE', 26: 'PETROCHEMICAL FEEDSTOCKS', 27: 'COKING COAL', 29: 'STILL GAS', 30: 'LUBRICANTS'}})

        self.assertEqual(output.outputs_id_map(), expected_id_map)